---
phase: 06-logging-migration
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - app/src-tauri/src/service/mod.rs
  - app/src-tauri/src/service/directory.rs
  - app/src-tauri/src/commands/effects.rs
  - app/src-tauri/src/commands/encounters.rs
  - app/src-tauri/src/hotkeys.rs
autonomous: true

must_haves:
  truths:
    - "Zero eprintln! calls in app/src-tauri/src/service/"
    - "Zero eprintln! calls in app/src-tauri/src/commands/"
    - "Zero eprintln! calls in app/src-tauri/src/hotkeys.rs"
    - "Parse timing logged at info level"
    - "Icon loading logged at debug level"
  artifacts:
    - path: "app/src-tauri/src/service/mod.rs"
      provides: "Combat service with structured logging"
      contains: "tracing::"
  key_links:
    - from: "app/src-tauri/src/service/mod.rs"
      to: "tracing"
      via: "use tracing"
      pattern: "tracing::(info|debug|error|warn)"
---

<objective>
Migrate app/src-tauri eprintln! calls to tracing macros

Purpose: Backend service diagnostics should use structured logging so they appear in log files. Service module has the most eprintln! calls (~35).

Output: All production eprintln! in service/, commands/, and hotkeys.rs converted to appropriate tracing macros with structured fields.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-logging-migration/06-CONTEXT.md
@.planning/phases/06-logging-migration/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate service module eprintln! calls</name>
  <files>app/src-tauri/src/service/mod.rs, app/src-tauri/src/service/directory.rs</files>
  <action>
Migrate all eprintln! in service/ to tracing (~25 calls in mod.rs, 1 in directory.rs).

**Level mapping per CONTEXT.md:**

ERROR level (all caught errors):
- `Failed to load icon cache: {}` -> `tracing::error!(error = %e, "Failed to load icon cache")`
- `Failed to remove old effects directory: {}` -> `tracing::error!(...)`
- `Subprocess output parse failed: {}` -> `tracing::error!(...)`
- `Failed to spawn subprocess: {}` -> `tracing::error!(...)`
- Directory watcher errors -> `tracing::error!(...)`

WARN level (degraded but working):
- `Failed to load timer preferences: {}` -> `tracing::warn!(...)`
- `Failed to clear data directory: {}` -> `tracing::warn!(...)`

INFO level (user operations per CONTEXT.md):
- `[PARSE] Total time: {:.0}ms` -> `tracing::info!(elapsed_ms = ..., "Parse completed")`
- `Loaded icon cache from {:?}` -> `tracing::info!(path = ?icons_dir, "Loaded icon cache")`
- Effects loading counts -> `tracing::info!(count = ..., "Loaded effects definitions")`

DEBUG level (internal diagnostics):
- `[PARSE] Using worker: {:?}` -> `tracing::debug!(worker_path = ?path, "Using parse worker")`
- `[PARSE] Using definitions: {:?}` -> `tracing::debug!(...)`
- `[ICONS] Initializing icon cache...` -> `tracing::debug!("Initializing icon cache")`
- `[ICONS] Looking for icons at {:?}` -> `tracing::debug!(path = ?icons_dir, "Looking for icons")`
- Effects directory operations -> `tracing::debug!(...)`

**directory.rs:**
- `Directory watcher error: {}` -> `tracing::error!(error = %err, "Directory watcher error")`

Remove [PARSE], [ICONS], [EFFECTS] prefixes - tracing targets handle this.
  </action>
  <verify>`grep -rn "eprintln!" app/src-tauri/src/service/` returns empty</verify>
  <done>Zero eprintln! in service module</done>
</task>

<task type="auto">
  <name>Task 2: Migrate commands and hotkeys eprintln! calls</name>
  <files>app/src-tauri/src/commands/effects.rs, app/src-tauri/src/commands/encounters.rs, app/src-tauri/src/hotkeys.rs</files>
  <action>
Migrate all eprintln! in commands/ and hotkeys.rs to tracing.

**commands/effects.rs (~1 call):**
- Warning about effect loading -> `tracing::warn!(...)`

**commands/encounters.rs (~7 calls):**
These are debug/diagnostic calls for encounter loading:
- `[ENCOUNTERS] load_file_with_custom: {:?}` -> `tracing::debug!(file_path = ?path, "load_file_with_custom")`
- `[ENCOUNTERS] user_dir: {:?}` -> `tracing::debug!(user_dir = ?dir, "User definition directory")`
- `[ENCOUNTERS] Loaded {} boss definitions` -> `tracing::debug!(count = bosses.len(), "Loaded boss definitions")`
- Path exists checks -> `tracing::debug!(...)`

**hotkeys.rs (~8 calls, Windows/macOS only):**
- `Failed to register X hotkey: {}` -> `tracing::error!(error = %e, hotkey = %key_str, "Failed to register hotkey")`
- `Registered X hotkey: {}` -> `tracing::info!(hotkey = %key_str, "Registered hotkey")`
- `Invalid X hotkey format: {}` -> `tracing::warn!(hotkey = %key_str, "Invalid hotkey format")`

Remove [ENCOUNTERS], [HOTKEY] prefixes - tracing targets handle this.
  </action>
  <verify>
`grep -rn "eprintln!" app/src-tauri/src/commands/` returns empty
`grep -n "eprintln!" app/src-tauri/src/hotkeys.rs` returns empty
  </verify>
  <done>Zero eprintln! in commands and hotkeys modules</done>
</task>

</tasks>

<verification>
- [ ] `grep -rn "eprintln!" app/src-tauri/src/service/` returns nothing
- [ ] `grep -rn "eprintln!" app/src-tauri/src/commands/` returns nothing
- [ ] `grep -n "eprintln!" app/src-tauri/src/hotkeys.rs` returns nothing
- [ ] `cargo check -p app` compiles without errors
- [ ] Log levels follow CONTEXT.md (errors at error, info operations at info, internals at debug)
</verification>

<success_criteria>
1. All eprintln! in service/ converted to tracing with structured fields
2. All eprintln! in commands/ converted to tracing
3. All eprintln! in hotkeys.rs converted to tracing
4. Prefixes like [PARSE], [ICONS] removed (tracing targets replace them)
5. Log levels follow CONTEXT.md mapping
</success_criteria>

<output>
After completion, create `.planning/phases/06-logging-migration/06-03-SUMMARY.md`
</output>
